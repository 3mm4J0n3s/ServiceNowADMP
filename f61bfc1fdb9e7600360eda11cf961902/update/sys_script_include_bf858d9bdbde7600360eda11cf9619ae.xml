<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_manen_admanager.ADManagerActionHandler</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description/>
        <name>ADManagerActionHandler</name>
        <script><![CDATA[var ADManagerActionHandler = Class.create();
ADManagerActionHandler.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
	toggleModulesCatalogs: function(state) {
		var moduleList = 'Associate User, Actions, User Management, Create User, Delete User, Disable User, Enable User, Reset Password, Unlock User, Modify Manager, Modify Department, Add to Group, Remove from Group, File Server Management, Set Folder Permissions, Remove Folder Permissions';
		this.toggleModuleVisibility(moduleList, state);

		var catalogItemList = 'Create User, Delete User, Disable User, Enable User, Reset Password, Unlock User, Modify Manager, Modify Department, Add to Group, Remove from Group, Set Folder Permissions, Remove Folder Permissions';
		this.toggleCatalogItemVisibility(catalogItemList, state);

		// 		var actionList = 'Create AD User, Delete AD User, Disable AD User, Enable AD User, Reset AD Password, Unlock AD User, Modify Manager, Modify Department, Add to Group, Remove from Group, Set Folder Permissions, Remove Folder Permissions';
		// 		this.toggleFormActionVisibility(actionList, state);
	},
	toggleModuleVisibility: function(moduleList, state) {
		// To activate/deactivate, ADManager Plus modules
		var moduleRecord = new GlideRecordSecure('sys_app_module');
		moduleRecord.addQuery('title', 'IN', moduleList);
		moduleRecord.addQuery('application', '151909dfdbde7600360eda11cf961906'); // sys_id of Application Menu 'ADManager Plus'
		moduleRecord.query();
		while(moduleRecord.next()) {
			moduleRecord.active = state;
			moduleRecord.update();
		}
	},
	toggleCatalogItemVisibility: function(catalogItemList, state) {
		// To activate/deactivate, ADManager Plus catalog items
		var catalogRecord = new GlideRecordSecure('sc_cat_item');
		catalogRecord.addQuery('name', 'IN', catalogItemList);
		catalogRecord.query();
		while(catalogRecord.next()) {
			catalogRecord.active = state;
			catalogRecord.update();
		}
	},
	setModuleHint: function(moduleList, hint) {
		// To set/remove, ADManager Plus modules hint
		var moduleRecord = new GlideRecordSecure('sys_app_module');
		moduleRecord.addQuery('title', 'IN', moduleList);
		moduleRecord.addQuery('application', '151909dfdbde7600360eda11cf961906'); // sys_id of Application Menu 'ADManager Plus'
		moduleRecord.query();
		while(moduleRecord.next()) {
			moduleRecord.hint = hint;
			moduleRecord.update();
		}
	},
	// 	toggleFormActionVisibility: function(actionList, state) {
	// 		// To activate/deactivate, ADManager Plus form context menu actions
	// 		var actionRecord = new GlideRecordSecure('sys_ui_action');
	// 		actionRecord.addQuery('name', 'IN', actionList);
	// 		actionRecord.query();
	// 		while(actionRecord.next()) {
	// 			actionRecord.active = state;
	// 			actionRecord.update();
	// 		}
	// 	},
	type: 'ADManagerActionHandler'
});
]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2017-04-28 09:48:23</sys_created_on>
        <sys_id>bf858d9bdbde7600360eda11cf9619ae</sys_id>
        <sys_mod_count>98</sys_mod_count>
        <sys_name>ADManagerActionHandler</sys_name>
        <sys_package display_value="ADManager Plus" source="x_manen_admanager">f61bfc1fdb9e7600360eda11cf961902</sys_package>
        <sys_policy>protected</sys_policy>
        <sys_scope display_value="ADManager Plus">f61bfc1fdb9e7600360eda11cf961902</sys_scope>
        <sys_update_name>sys_script_include_bf858d9bdbde7600360eda11cf9619ae</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-01-19 07:35:27</sys_updated_on>
    </sys_script_include>
</record_update>
